# Ghoul Service Requests

| **Service**                 | **Description**                                                                                                                                                                                                                                                                                                         | **Example Usage**                                                                                                                                                                                                                                                                                                                  |
|:--------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| SERVICE_SHOW (0)            | Commands ghoul to stop hiding. Ghoul will now be visible in procfs and sysfs.                                                                                                                                                                                                                                           | `./ghoulctl.py show`                                                                                                                                                                                                                                                                                                               |
| SERVICE_HIDE (1)            | Commands ghoul to go back to hiding.                                                                                                                                                                                                                                                                                    | `./ghoulctl.py hide`                                                                                                                                                                                                                                                                                                               |
| SERVICE_UNLOAD (2)          | Unloads ghoul.                                                                                                                                                                                                                                                                                                          | `./ghoulctl.py unload`                                                                                                                                                                                                                                                                                                             |
| SERVICE_CHANGE_FD (3)       | Changes the fd needed to send service requests.                                                                                                                                                                                                                                                                         | `./ghoulctl.py change-fd 1234`. ghoulctl.py uses the default fd (666). After changing it, the `--fd` argument needs to be specified with each use of ghoulctl, or the `GHOUL_FD` environment variable needs to be set.                                                                                                             |
| SERVICE_PING (4)            | Pings ghoul to see if it's loaded. Requires a special argument for "authentication" (predefined to 666).                                                                                                                                                                                                                | `./ghoulctl.py ping` (uses the default argument). To specify a different argument: `./ghoulctl.py ping --arg 1234` or set the `GHOUL_PING_ARG` environment variable.                                                                                                                                                               |
| SERVICE_CHANGE_PING_ARG (5) | Changes the argument required to ping ghoul.                                                                                                                                                                                                                                                                            | `./ghoulctl.py change-ping-arg 1234`                                                                                                                                                                                                                                                                                               |
| SERVICE_GIVE_ROOT (6)       | Gives a process root privileges. A PID of -1 specifies the parent process, 0 specifies the current process.                                                                                                                                                                                                             | `./ghoulctl.py give-root` (uses default PID -1, useful when running ghoulctl.py from a shell). To specify a different PID: `./ghoulctl.py give-root 1234`                                                                                                                                                                          |
| SERVICE_HIDE_FILE_INODE (7) | Hides a file by its inode number. This is intended to hide regular files, but it also hides directories (only basic testing was done on this)                                                                                                                                                                           | `./ghoulctl.py hide-inode 1234`                                                                                                                                                                                                                                                                                                    |
| SERVICE_SHOW_FILE_INODE (8) | Unhides a previously hidden file by its inode. In addition to the inode to unhide, the PID which the file should be unhidden from needs to be specified. A PID of 0 specifies all PIDs, and -1 specifies the parent PID. A common workflow would be to hide a file and then show it only to our user mode process' PID. | `./ghoulctl.py show-inode 1234` (uses default PID 0). To specify a different PID: `./ghoulctl.py show-inode 1234 --pid 5678`. To unhide the file from the shell (parent) process: `./ghoulctl.py show-inode 1234 --pid -1` (note that the file will still be hidden from commands spawned by the shell, as they're new processes). |


